<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Ресурсы предприятия</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
  <h2>Ресурсы предприятия</h2>

  <ul class="nav nav-tabs" id="resourceTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="equipment-tab" data-bs-toggle="tab" data-bs-target="#equipment" type="button" role="tab">Оборудование</button>
    </li>
    <!-- Будущие вкладки -->
    <li class="nav-item" role="presentation">
      <button class="nav-link disabled" type="button" role="tab">Сотрудники</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link disabled" type="button" role="tab">Материалы</button>
    </li>
  </ul>

  <div class="tab-content mt-3" id="resourceTabsContent">
    <div class="tab-pane fade show active" id="equipment" role="tabpanel">

      <form class="row g-3" th:action="@{/resources}" method="get" th:object="${equipmentFilterDTO}">
        <div class="col-md-3">
          <label for="name" class="form-label">Название</label>
          <input type="text" th:field="*{name}" class="form-control" id="name">
        </div>

        <div class="col-md-3">
          <label for="type" class="form-label">Тип</label>
          <input type="text" th:field="*{type}" class="form-control" id="type">
        </div>

        <div class="col-md-3">
          <label for="model" class="form-label">Модель</label>
          <input type="text" th:field="*{model}" class="form-control" id="model">
        </div>

        <div class="col-md-3">
          <label for="serialNumber" class="form-label">Серийный номер</label>
          <input type="text" th:field="*{serialNumber}" class="form-control" id="serialNumber">
        </div>

        <div class="col-md-3">
          <label for="location" class="form-label">Локация</label>
          <input type="text" th:field="*{location}" class="form-control" id="location">
        </div>

        <div class="col-md-3">
          <label for="status" class="form-label">Статус</label>
          <input type="text" th:field="*{status}" class="form-control" id="status">
        </div>

        <div class="col-md-3">
          <label for="supplier" class="form-label">Поставщик</label>
          <input type="text" th:field="*{supplier}" class="form-control" id="supplier">
        </div>

        <div class="col-md-3">
          <label for="purchaseDateFrom" class="form-label">Дата закупки (от)</label>
          <input type="date" th:field="*{purchaseDateFrom}" class="form-control" id="purchaseDateFrom">
        </div>

        <div class="col-md-3">
          <label for="purchaseDateTo" class="form-label">Дата закупки (до)</label>
          <input type="date" th:field="*{purchaseDateTo}" class="form-control" id="purchaseDateTo">
        </div>

        <div class="col-md-3">
          <label for="warrantyExpirationFrom" class="form-label">Гарантия от</label>
          <input type="date" th:field="*{warrantyExpirationFrom}" class="form-control" id="warrantyExpirationFrom">
        </div>

        <div class="col-md-3">
          <label for="warrantyExpirationTo" class="form-label">Гарантия до</label>
          <input type="date" th:field="*{warrantyExpirationTo}" class="form-control" id="warrantyExpirationTo">
        </div>

        <div class="col-md-3">
          <label for="lastMaintenanceFrom" class="form-label">Последнее ТО (от)</label>
          <input type="date" th:field="*{lastMaintenanceFrom}" class="form-control" id="lastMaintenanceFrom">
        </div>

        <div class="col-md-3">
          <label for="lastMaintenanceTo" class="form-label">Последнее ТО (до)</label>
          <input type="date" th:field="*{lastMaintenanceTo}" class="form-control" id="lastMaintenanceTo">
        </div>

        <div class="col-md-3">
          <label for="nextMaintenanceFrom" class="form-label">Следующее ТО (от)</label>
          <input type="date" th:field="*{nextMaintenanceFrom}" class="form-control" id="nextMaintenanceFrom">
        </div>

        <div class="col-md-3">
          <label for="nextMaintenanceTo" class="form-label">Следующее ТО (до)</label>
          <input type="date" th:field="*{nextMaintenanceTo}" class="form-control" id="nextMaintenanceTo">
        </div>

        <div class="col-md-3">
          <label for="costMin" class="form-label">Стоимость от</label>
          <input type="number" step="0.01" th:field="*{costMin}" class="form-control" id="costMin">
        </div>

        <div class="col-md-3">
          <label for="costMax" class="form-label">Стоимость до</label>
          <input type="number" step="0.01" th:field="*{costMax}" class="form-control" id="costMax">
        </div>

        <div class="col-md-3 align-self-end">
          <button type="submit" class="btn btn-primary w-100">Фильтровать</button>
        </div>

        <a th:href="@{/resources/equipment/export(
            name=${equipmentFilterDTO.name},
            type=${equipmentFilterDTO.type},
            model=${equipmentFilterDTO.model},
            serialNumber=${equipmentFilterDTO.serialNumber},
            location=${equipmentFilterDTO.location},
            status=${equipmentFilterDTO.status},
            supplier=${equipmentFilterDTO.supplier},
            purchaseDateFrom=${equipmentFilterDTO.purchaseDateFrom},
            purchaseDateTo=${equipmentFilterDTO.purchaseDateTo},
            warrantyExpirationFrom=${equipmentFilterDTO.warrantyExpirationFrom},
            warrantyExpirationTo=${equipmentFilterDTO.warrantyExpirationTo},
            lastMaintenanceFrom=${equipmentFilterDTO.lastMaintenanceFrom},
            lastMaintenanceTo=${equipmentFilterDTO.lastMaintenanceTo},
            nextMaintenanceFrom=${equipmentFilterDTO.nextMaintenanceFrom},
            nextMaintenanceTo=${equipmentFilterDTO.nextMaintenanceTo},
            costMin=${equipmentFilterDTO.costMin},
            costMax=${equipmentFilterDTO.costMax}
        )}" class="btn btn-success mt-3">Экспорт в Excel</a>
      </form>

      <table class="table table-striped table-hover mt-4">
        <thead>
        <tr>
          <th>ID</th>
          <th>Название</th>
          <th>Тип</th>
          <th>Модель</th>
          <th>Серийный номер</th>
          <th>Локация</th>
          <th>Дата закупки</th>
          <th>Гарантия до</th>
          <th>ТО (посл./след.)</th>
          <th>Статус</th>
          <th>Поставщик</th>
          <th>Стоимость</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="equipment : ${equipmentList}">
          <td th:text="${equipment.id}"></td>
          <td th:text="${equipment.name}"></td>
          <td th:text="${equipment.type}"></td>
          <td th:text="${equipment.model}"></td>
          <td th:text="${equipment.serialNumber}"></td>
          <td th:text="${equipment.location}"></td>
          <td th:text="${#temporals.format(equipment.purchaseDate, 'dd.MM.yyyy')}"></td>
          <td th:text="${#temporals.format(equipment.warrantyExpiration, 'dd.MM.yyyy')}"></td>
          <td>
            <span th:text="${#temporals.format(equipment.lastMaintenance, 'dd.MM.yyyy')}"></span>
            <span th:text="${#temporals.format(equipment.nextMaintenance, 'dd.MM.yyyy')}"></span>
          </td>
          <td th:text="${equipment.status}"></td>
          <td th:text="${equipment.supplier}"></td>
          <td th:text="${equipment.cost}"></td>
        </tr>
        </tbody>
      </table>

    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
